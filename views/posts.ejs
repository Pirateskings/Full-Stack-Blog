<%- include('partials/header', { title, user }) %>

  <div class="container my-5">
    <h1 class="text-center display-4 mb-4">Latest Posts <span class="badge bg-secondary">
        <%= posts.length %>
      </span></h1>

    <% if (posts && posts.length> 0) { %>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        <% posts.forEach(post=> { %>
          <div class="col">
            <div class="card shadow-sm h-100 border-0 rounded-3 overflow-hidden">
              <% if (post.images && post.images.length> 0) { %>
                <img src="<%= post.images[0].url %>" class="card-img-top" alt="Post Image"
                  style="height: 200px; object-fit: cover;">
                <% } %>
                  <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-primary">
                      <%= post.title %>
                    </h5>
                    <p class="text-muted small">By <strong>
                        <%= post.author ? post.author.username : "Unknown" %>
                      </strong> - <%= post.createdAt ? new Date(post.createdAt).toDateString() : "Unknown Date" %>
                    </p>
                    <a href="/posts/<%= post._id %>" class="btn btn-outline-primary mt-auto">Read More</a>
                  </div>
            </div>
          </div>
          <% }) %>
      </div>
      <% } else { %>
        <p class="text-center text-muted fs-4">No posts available.</p>
        <% } %>
  </div>

  <%- include('partials/footer') %>